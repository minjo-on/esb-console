<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd" >

	<http pattern="/login.jsp" security="none"/>
	<http pattern="/install.jsp" security="none"/>
	<http auto-config="true" entry-point-ref="exceptionHandler">
		<intercept-url pattern="/*" access="ROLE_USER" />
		<intercept-url pattern="/openAPI/*" access="ROLE_USER" />
		<form-login login-page="/login.jsp" 
					authentication-failure-handler-ref="loginFailureHandler" authentication-failure-url="" 
					authentication-success-handler-ref="loginSuccessHandler"/>
		<logout invalidate-session="true" logout-url="/logout" logout-success-url="/login.jsp"/>
	</http>

	<authentication-manager>
	   <authentication-provider ref="authService" />
	</authentication-manager>

	<beans:bean id="authService" class="com.indigo.web.login.IndigoAuthenticationProvider"/>

	<beans:bean id="loginService" class="com.indigo.web.login.SpringSecurityLoginService"/>
	<beans:bean id="loginSuccessHandler" class="com.indigo.web.login.SpringSecurityLoginSuccessHandler"/>
	<beans:bean id="loginFailureHandler" class="com.indigo.web.login.SpringSecurityloginFailureHandler">
		<beans:property name="failureUrl" value="/login.jsp"/>
	</beans:bean>
	<beans:bean id="encoder" class="com.indigo.web.login.SpringSecurityPasswordEncoder"/>
	
	<beans:bean id="exceptionHandler" class="com.indigo.web.login.SpringSecurityAuthenticationException">
		<beans:constructor-arg name="loginFormUrl" value="/login.jsp"/>
	</beans:bean>
</beans:beans>